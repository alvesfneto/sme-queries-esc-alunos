
SELECT * FROM [dbo].[VW_CADASTRO_ESCOLAS_DIVULGACAO_EOL] WHERE CEU IS NOT NULL


SELECT 
CD_ESCOLA,
CASE
    WHEN CD_ESCOLA IN (019328,019333,200237,400596,700019,700519) THEN 200237
    WHEN CD_ESCOLA IN (700044,400696,200260,019382,019391,700549) THEN 200260
    WHEN CD_ESCOLA IN (200183,019260,019279,400512,700038,700547) THEN 200183
    WHEN CD_ESCOLA IN (700023,400513,019280,019261,200184,090905,700528) THEN 200184
    WHEN CD_ESCOLA IN (019334,019329,019214,019227,400597,200238,700024,700529) THEN 200238
    WHEN CD_ESCOLA IN (200798,019667,700049,700523) THEN 200798
    WHEN CD_ESCOLA IN (200185,019262,019281,400514,700000,700501) THEN 200185
    WHEN CD_ESCOLA IN (400684,700039,200251,019371,019373,700548) THEN 200251
    WHEN CD_ESCOLA IN (019307,019308,200203,400536,700003,700504) THEN 200203
    WHEN CD_ESCOLA IN (700006,400670,200244,019353,019361,700505) THEN 200244
    WHEN CD_ESCOLA IN (019374,019383,200252,400688,700008,700506) THEN 200252
    WHEN CD_ESCOLA IN (700002,200201,400534,019302,019303,700507) THEN 200201
    WHEN CD_ESCOLA IN (019198,019282,019263,200186,400515,700010,700511) THEN 200186
    WHEN CD_ESCOLA IN (200805,019664,700055,700546) THEN 200805
    WHEN CD_ESCOLA IN (019335,019338,400598,200239,700004,700508) THEN 200239
    WHEN CD_ESCOLA IN (400691,700025,200255,019377,019386,700530) THEN 200255
    WHEN CD_ESCOLA IN (019661,200799,700050,700518) THEN 200799
    WHEN CD_ESCOLA IN (200243,400669,700005,019360,019352,700509) THEN 200243
    WHEN CD_ESCOLA IN (091979,400702,400703,400709,700045,200262,095044,700524) THEN 200262
    WHEN CD_ESCOLA IN (200806,019669,700056,700538) THEN 200806
    WHEN CD_ESCOLA IN (200187,019264,019284,400516,700017,700520) THEN 200184
    WHEN CD_ESCOLA IN (700026,400600,200241,019332,019337,700533) THEN 200241
    WHEN CD_ESCOLA IN (019392,019390,200259,400695,700037,700540) THEN 200259
    WHEN CD_ESCOLA IN (700018,400517,200188,019285,019265,700521) THEN 200188
    WHEN CD_ESCOLA IN (019355,019363,200246,700016,400672,700516) THEN 200246
    WHEN CD_ESCOLA IN (200800,019668,700051,700532) THEN 200800
    WHEN CD_ESCOLA IN (019368,019369,019315,019310,200247,400673,700020,700522)THEN 200247
    WHEN CD_ESCOLA IN (700021,400518,019266,019286,091987,200189,700525) THEN 200189
    WHEN CD_ESCOLA IN (019670,200804,700054,700539) THEN 200804
    WHEN CD_ESCOLA IN (400519,019674,700011,200190,019287,019268,700512) THEN 200190
    WHEN CD_ESCOLA IN (019671,200801,700052,700534) THEN 200801
    WHEN CD_ESCOLA IN (200253,400689,700009,019375,019384,700503) THEN 200253
    WHEN CD_ESCOLA IN (019441,019442,019313,700014,400710,200261,700513) THEN 200261
    WHEN CD_ESCOLA IN (200258,400694,700036,019389,019380,700541) THEN 200258
    WHEN CD_ESCOLA IN (019385,019376,700022,400690,200254,700526) THEN 200254
    WHEN CD_ESCOLA IN (200794,700047,019657,700531) THEN 200794
    WHEN CD_ESCOLA IN (200191,013226,019269,019288,700027,400520,700554) THEN 200192
    WHEN CD_ESCOLA IN (400521,700028,019289,019270,019226,200192,700555) THEN 200192
    WHEN CD_ESCOLA IN (094374,019304,019306,700015,400535,200202,700517)THEN 200202
    WHEN CD_ESCOLA IN (400522,700033,019271,019290,200193,700542) THEN 200193
    WHEN CD_ESCOLA IN (200194,019292,019272,019330,700034,400523,700543) THEN 200194
    WHEN CD_ESCOLA IN (200803,019663,700053,700545) THEN 200803
    WHEN CD_ESCOLA IN (019365,019357,200248,700031,400674,700536) THEN 200248
    WHEN CD_ESCOLA IN (700042,200200,099121,400529,019298,019299,700550) THEN 200200
    WHEN CD_ESCOLA IN (019273,019293,019640,200195,400524,700040,700551) THEN 200195
    WHEN CD_ESCOLA IN (700057,019662,200807,700558) THEN 200807
    WHEN CD_ESCOLA IN (700041,400525,200196,019364,019294,019274,700552) THEN 200196
    WHEN CD_ESCOLA IN (019358,019366,200249,700043,400675,700553) THEN 200249
    WHEN CD_ESCOLA IN (400693,700032,200257,400282,019379,019388,019234,700537)THEN 200257
    WHEN CD_ESCOLA IN (019665,200795,700048,700535) THEN 200795
    WHEN CD_ESCOLA IN (700012,400526,200197,019276,019295,700514) THEN 200197
    WHEN CD_ESCOLA IN (019367,200250,400676,700030,700556) THEN 200250
    WHEN CD_ESCOLA IN (400692,700001,200256,019387,019551,019378,700502) THEN 200256
    WHEN CD_ESCOLA IN (019659,200793,700046,700527) THEN 200793
    WHEN CD_ESCOLA IN (700035,400527,200198,019296,019277,700544) THEN 200198
    WHEN CD_ESCOLA IN (019278,019297,200199,400528,700029,700557) THEN 200199
    WHEN CD_ESCOLA IN (700007,400671,200245,019362,019354,700510) THEN 200245
    WHEN CD_ESCOLA IN (019331,019336,200240,400599,700013,700515) THEN 200240
ELSE NULL END AS 'CEU'
FROM D_ESCOLA

SELECT  * FROM D_UNIDADE_EDUCACAO WHERE cd_unidade_educacao LIKE '200%'

SELECT * FROM D_UNIDADE_ADMINISTRATIVA WHERE TP_unidade_administrativa =19



SELECT cd_unidade_administrativa,
CASE WHEN tp_ocorrencia_historica=1 THEN dc_ato ELSE NULL END AS NM_CRIACAO
--CASE WHEN tp_ocorrencia_historica=11 THEN dc_ato ELSE NULL END AS NM_ATUAL

--DC_ATO,MAX(B.DT_ATUALIZACAO_TABELA) 



FROM D_HISTORICO_UNIDADE A
JOIN D_UNIDADE_ADMINISTRATIVA B ON A.cd_unidade_educacao=B.cd_unidade_administrativa

WHERE tp_unidade_administrativa=19 --AND tp_ocorrencia_historica =1
GROUP BY cd_unidade_administrativa,DC_ATO,tp_ocorrencia_historica


SELECT 
cd_unidade_educacao AS CD_ESCOLA,
dc_ato AS NM_CRIACAO,
dt_inicio_ocorrencia_unidade AS DT_CRIACAO

 FROM D_HISTORICO_UNIDADE A
JOIN (SELECT 
	  cd_unidade_administrativa 
	  FROM D_UNIDADE_ADMINISTRATIVA 
	  WHERE tp_unidade_administrativa=19) B ON A.cd_unidade_educacao=B.cd_unidade_administrativa
WHERE tp_ocorrencia_historica=1 AND tp_atualizacao_registro is null


SELECT distinct *
--MAX(cd_historico_unidade),
--cd_unidade_educacao AS CD_ESCOLA,
--dc_ato AS NM_ATUAL


FROM D_HISTORICO_UNIDADE A  
RIGHT JOIN (SELECT 
	  cd_unidade_administrativa 
	  FROM D_UNIDADE_ADMINISTRATIVA 
	  WHERE tp_unidade_administrativa=19) B ON A.cd_unidade_educacao=B.cd_unidade_administrativa
WHERE tp_ocorrencia_historica=11 AND tp_atualizacao_registro is null
--group by cd_unidade_educacao,dc_ato
ORDER BY cd_unidade_educacao


--TABELA CRIACAO DOS CEUS

SELECT 
A.cd_unidade_administrativa,
B.NM_CRIACAO,
C.NM_ATUAL
FROM 
D_UNIDADE_ADMINISTRATIVA A
RIGHT JOIN(SELECT
            A.cd_unidade_educacao,
            dc_ato AS NM_CRIACAO 
            FROM 
            D_HISTORICO_UNIDADE A 
            RIGHT JOIN (SELECT
                         MIN(cd_historico_unidade) AS CD_HISTORICO_UNIDADE,
	                     cd_unidade_educacao
	                     FROM D_HISTORICO_UNIDADE A
	                     JOIN D_UNIDADE_ADMINISTRATIVA B ON A.cd_unidade_educacao=B.cd_unidade_administrativa
	                     WHERE tp_ocorrencia_historica=1 AND tp_unidade_administrativa=19
                         group by cd_unidade_educacao) B ON A.cd_historico_unidade=B.CD_HISTORICO_UNIDADE) B ON A.cd_unidade_administrativa=B.cd_unidade_educacao

--TABELA COM CEUS QUE MUDARAM DE NOME
RIGHT JOIN (SELECT
             A.cd_unidade_educacao,
             dc_ato AS NM_ATUAL 
             FROM 
             D_HISTORICO_UNIDADE A
             JOIN (SELECT
                    MAX(cd_historico_unidade) AS CD_HISTORICO_UNIDADE,
	                cd_unidade_educacao
	                FROM D_HISTORICO_UNIDADE A
	                JOIN D_UNIDADE_ADMINISTRATIVA B ON A.cd_unidade_educacao=B.cd_unidade_administrativa
	                WHERE tp_ocorrencia_historica=11 AND tp_unidade_administrativa=19
                    group by cd_unidade_educacao) C ON A.cd_historico_unidade=C.CD_HISTORICO_UNIDADE
                    WHERE nr_ato <>'47.302') C ON A.cd_unidade_administrativa=C.cd_unidade_educacao






























































