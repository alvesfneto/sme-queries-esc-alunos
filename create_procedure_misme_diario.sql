USE [Db_local]
GO

/****** Object:  StoredProcedure [dbo].[GERA_MISME_DIARIO]    Script Date: 20/06/2024 13:57:06 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE PROC [dbo].[GERA_MISME_DIARIO]

AS


--ajustado para educacao especial

EXEC PROC_AUX_MIEST

--DECLARE @date VARCHAR(255) = '12/5/2019';  
--SELECT EOMONTH ( @date ) AS Result;  

DECLARE @DURCLASSE INT SET @DURCLASSE = 0 
DECLARE @SEMESTRE DATE SET @SEMESTRE = '2010-07-21' 

      IF (SELECT DISTINCT MIN(AN_LETIVO) FROM D_TURMA_ESCOLA) > YEAR(GETDATE()) 
         (SELECT @DURCLASSE = @DURCLASSE + 2) 
  ELSE
  
  IF MONTH(@SEMESTRE) < MONTH(GETDATE()) 
 (SELECT @DURCLASSE = @DURCLASSE + 1) 
  ELSE 
 (SELECT @DURCLASSE = @DURCLASSE + 2)


/*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----ESSE AJUSTE SERA RODADO SOMENTE NO SEGUNDO SEMESTRE DE 2020 PARA AJUSTE DAS CLASSES PROFISISONALIZANTE E PROFISSIONALIZANTE BASICA DE SEMESTRAL PARA ANULA
-- AS CLASSES DE EJA JA FORAM AJUSTADAS NA ORIGEM...
--VERIFICAR COMO FICARÁ NO DECORRER DO MES DE AGOSTO/2020 SE FOR MANTIDO REGRA, AJUSTAR NAQUERIE DE BACKUP


 IF 
	(SELECT	MAX(AN_LETIVO) FROM D_TURMA_ESCOLA) = 2020

	update a set CD_TIPO_PERIODICIDADE = 1 

	FROM SME_CLASSES_DIARIO A
	WHERE	
			AN_LETIVO = 2020 
			AND CD_TIPO_PERIODICIDADE = 3 
			and (CD_ETAPA_ENSINO = 14 OR CD_TIPO_PROGRAMA IN (13,27,32,33,44,70))
ELSE 
	PRINT ' NÃO ATUALIZADO'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

--/*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----MISME ESCOLA TOTAL + COMPATIBLIZADOS
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/


IF EXISTS 
(SELECT * FROM SYSOBJECTS WHERE NAME = 'D_MISME_ESCOLA_TOTAL_COMPAT')
DROP TABLE D_MISME_ESCOLA_TOTAL_COMPAT



SELECT	NOMEDEP	,
		REDE	,
		DRE	,
		DISTR	,
		SETOR	,
		SG_TP_ESCOLA	,
		A.CD_ESCOLA	,
		COD_ESC	,
		NOMESC	,
		ENDERECO	,
		NR	,
		COMPL	,
		BAIRRO	,
		CEP	,
		DDD	,
		FONE1	,
		FONE2	,
		FAX	,
		EMAIL	,
		ZONA	,
		TURNO_M	,
		TURNO_I	,
		TURNO_T	,
		TURNO_V	,
		TURNO_N	,
		TURNO_G	,
		TURNOS	,
		MT_EI				+ISNULL(SL_EI,0)			  AS MT_EI				,
		MT_CRECHE			+ISNULL(SL_CRECHE,0)		  AS MT_CRECHE			,
		MT_B1				+ISNULL(SL_B1,0) 			  AS MT_B1				,
		MT_B2				+ISNULL(SL_B2,0) 			  AS MT_B2				,
		MT_MG1				+ISNULL(SL_MG1,0)			  AS MT_MG1				,
		MT_MG2				+ISNULL(SL_MG2,0)			  AS MT_MG2				,
		MT_MG_UNI			+ISNULL(SL_MG_UNI,0)		  AS MT_MG_UNI			,
		MT_PRE				+ISNULL(SL_PRE,0)			  AS MT_PRE				,
		MT_IN1				+ISNULL(SL_IN1,0)			  AS MT_IN1				,
		MT_IN2				+ISNULL(SL_IN2,0)			  AS MT_IN2				,
		MT_IN_UNI			+ISNULL(SL_IN_UNI,0)		  AS MT_IN_UNI			,
				
		MT_FUND				+ISNULL(SL_FUND,0)			  AS MT_FUND			,
		MT_FINI				+ISNULL(SL_FINI,0)			  AS MT_FINI			,
		MT_F1				+ISNULL(SL_F1,0)			  AS MT_F1				,
		MT_F2				+ISNULL(SL_F2,0)			  AS MT_F2				,
		MT_F3				+ISNULL(SL_F3,0)			  AS MT_F3				,
		MT_F4				+ISNULL(SL_F4,0)			  AS MT_F4				,
		MT_F5				+ISNULL(SL_F5,0)			  AS MT_F5				,
		MT_FFIN				+ISNULL(SL_FFIN,0)			  AS MT_FFIN			,
		MT_F6				+ISNULL(SL_F6,0)			  AS MT_F6				,
		MT_F7				+ISNULL(SL_F7,0)			  AS MT_F7				,
		MT_F8				+ISNULL(SL_F8,0)			  AS MT_F8				,
		MT_F9				+ISNULL(SL_F9,0)			  AS MT_F9				,

		MT_MEDI				+ISNULL(SL_MEDI,0)			  AS MT_MEDI			,
		MT_M1				+ISNULL(SL_M1,0)			  AS MT_M1				,
		MT_M2				+ISNULL(SL_M2,0)			  AS MT_M2				,
		MT_M3				+ISNULL(SL_M3,0)			  AS MT_M3				,
		MT_M4				+ISNULL(SL_M4,0)			  AS MT_M4				,
		MT_EJA				+ISNULL(SL_EJA,0)			  AS MT_EJA				,
		MT_EJAI				+ISNULL(SL_EJAI,0)			  AS MT_EJAI			,
		MT_EJAII			+ISNULL(SL_EJAII,0)			  AS MT_EJAII			,
		MT_EJAALF_I			+ISNULL(SL_EJAALF_I ,0)		  AS MT_EJAALF_I		,
		MT_EJAALF_II		+ISNULL(SL_EJAALF_II,0)		  AS MT_EJAALF_II		,
		MT_EJABAS_I			+ISNULL(SL_EJABAS_I ,0)		  AS MT_EJABAS_I		,
		MT_EJABAS_II		+ISNULL(SL_EJABAS_II,0)		  AS MT_EJABAS_II		,
		MT_EJACOMP_I		+ISNULL(SL_EJACOMP_I,0)		  AS MT_EJACOMP_I		,
		MT_EJACOMP_II		+ISNULL(SL_EJACOMP_II,0)	  AS MT_EJACOMP_II		,
		MT_EJAFIN_I			+ISNULL(SL_EJAFIN_I,0)		  AS MT_EJAFIN_I		,
		MT_EJAFIN_II		+ISNULL(SL_EJAFIN_II,0)		  AS MT_EJAFIN_II		,
		MT_EJAMODULAR_I		+ISNULL(SL_EJAMODULAR_I,0)	  AS MT_EJAMODULAR_I	,
		MT_EJAMODULAR_II	+ISNULL(SL_EJAMODULAR_II,0)	  AS MT_EJAMODULAR_II	,
		MT_EJAMODULAR_III	+ISNULL(SL_EJAMODULAR_III,0)  AS MT_EJAMODULAR_III	,
		MT_EJAMODULAR_IV	+ISNULL(SL_EJAMODULAR_IV ,0)  AS MT_EJAMODULAR_IV	,
		MT_CIEJAMODULO_I	+ISNULL(SL_CIEJAMODULO_I,0)	  AS MT_CIEJAMODULO_I	,
		MT_CIEJAMODULO_II	+ISNULL(SL_CIEJAMODULO_II,0)  AS MT_CIEJAMODULO_II	,
		MT_CIEJAMODULO_III	+ISNULL(SL_CIEJAMODULO_III,0) AS MT_CIEJAMODULO_III	,
		MT_CIEJAMODULO_IV	+ISNULL(SL_CIEJAMODULO_IV ,0) AS MT_CIEJAMODULO_IV	,
		MT_PROF	,
		MT_PROF_BASICA	,
		MT_AEE_CONVENIO	,
		MT_MOVA	,
		MT_SRM	,
		MT_REC_PARAL	,
		MT_PAP	,
		MT_CELP,
		MT_ATIV_COMP	,
		CL_EI	,
		CL_CRECHE	,
		CL_B1	,
		CL_B2	,
		CL_MG1	,
		CL_MG2	,
		CL_MG_UNI,
		CL_PRE	,
		CL_IN1	,
		CL_IN2	,
		CL_IN_UNI	,

		CL_FUND	,
		CL_FINI	,
		CL_F1	,
		CL_F2	,
		CL_F3	,
		CL_F4	,
		CL_F5	,
		CL_FFIN	,
		CL_F6	,
		CL_F7	,
		CL_F8	,
		CL_F9	,

		CL_MEDI	,
		CL_M1	,
		CL_M2	,
		CL_M3	,
		CL_M4	,
		CL_EJA	,
		CL_EJAI	,
		CL_EJAII	,
		CL_EJAALF_I	,
		CL_EJAALF_II	,
		CL_EJABAS_I	,
		CL_EJABAS_II	,
		CL_EJACOMP_I	,
		CL_EJACOMP_II	,
		CL_EJAFIN_I	,
		CL_EJAFIN_II	,
		CL_EJAMODULAR_I	,
		CL_EJAMODULAR_II	,
		CL_EJAMODULAR_III	,
		CL_EJAMODULAR_IV	,
		CL_CIEJAMODULO_I	,
		CL_CIEJAMODULO_II	,
		CL_CIEJAMODULO_III	,
		CL_CIEJAMODULO_IV	,
		CL_PROF	,
		CL_PROF_BASICA	,
		CL_AEE_CONVENIO	,
		CL_MOVA	,
		CL_SRM	,
		CL_REC_PARAL	,
		CL_PAP,
		CL_CELP,
		CL_ATIV_COMP	,
		CRDATE	

		INTO D_MISME_ESCOLA_TOTAL_COMPAT	
		FROM (	SELECT 
					 NOMEDEP
					,REDE 
					,DRE
					,DISTR
					,SETOR
					,SG_TP_ESCOLA
					,A.CD_ESCOLA
					,RIGHT(COD_ESC,6) COD_ESC
					,NOMESC
					,ENDERECO
					,NR
					,COMPL
					,BAIRRO
					,CEP
					,DDD
					,FONE1
					,FONE2
					,FAX
					,UPPER(EMAIL) EMAIL
					,ZONA
					,TURNO_M = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'X' ELSE NULL END
					,TURNO_I = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'X' ELSE NULL END
					,TURNO_T = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'X' ELSE NULL END
					,TURNO_V = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'X' ELSE NULL END
					,TURNO_N = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'X' ELSE NULL END
					,TURNO_G = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'X' ELSE NULL END
				
					,TURNOS = ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'M' END,'') 
							+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'I' END,'')
							+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'T' END,'')
							+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'V' END,'')
							+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'N' END,'')
							+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'G' END,'')
				
				/*================================================================================================
				--ALUNOS
				================================================================================================*/
				--CRECHE/BERÇARIO
					,MT_EI = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END) 											
																																																																																							
					,MT_CRECHE = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)														
					,MT_B1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
					,MT_B2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
																																																																												
					--CRECHE/MINIGRUPOS																																																																														
					,MT_MG1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
																																																																																							
					--INFANTIL/PRE ESCOLA																																																																													
					,MT_PRE = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_IN1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,313)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
					,MT_IN2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (25,26,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_IN_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
					
					--FUNDAMENTAL
					,MT_FUND = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	
					,MT_FINI = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)										
					,MT_F1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F5 = SUM(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_FFIN = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)											
					,MT_F6 = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F7 = SUM(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F8 = SUM(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F9 = SUM(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					
					
					--MÉDIO
					,MT_MEDI = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)							
					,MT_M1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
									
					--EJA ANOS INICIAIS
					,MT_EJA		 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	 
					,MT_EJAI	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																									 
					,MT_EJAII	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																											 
				
					,MT_EJAALF_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJAALF_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					,MT_EJABAS_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJABAS_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					
					--EJA ANOS FINAIS
					,MT_EJACOMP_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJACOMP_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJAFIN_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																														 
					,MT_EJAFIN_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,MT_EJAMODULAR_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_III=SUM(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_IV=SUM(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,MT_CIEJAMODULO_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_III =SUM(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_CIEJAMODULO_IV =SUM(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					
					--ED. PROFISSIONAL
					,MT_PROF =SUM(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)
					
					--ED. PROFISSIONAL BASICA
					,MT_PROF_BASICA =SUM(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE   THEN AL_AT ELSE 0 END)
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[MT_AEE_CONVENIO] =SUM(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--MOVA
					,MT_MOVA =SUM(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--SRM ANTIGO SAAI
					,MT_SRM =SUM(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--RECUPERACAO PARALELA
					,MT_REC_PARAL =SUM(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)

					--SELECT * FROM ##TIPO_PROGRAMA
					,MT_PAP =SUM(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--CELP
					,MT_CELP =SUM(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)


					--ATIVIDADE COMPLEMENTAR
					,MT_ATIV_COMP =SUM(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)
				
				/*================================================================================================
				--CLASSES
				================================================================================================*/
					
					,CL_EI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_CRECHE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--CRECHE/MINIGRUPOS
					,CL_MG1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (321,322)    AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--INFANTIL/PRE ESCOLA
					,CL_PRE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,313) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (25,26,314) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--FUNDAMENTAL
					,CL_FUND = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FINI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F5 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FFIN = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F6 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F7 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F8 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F9 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--MÉDIO
					,CL_MEDI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--EJA ANOS INICIAIS
					,CL_EJA		 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAI	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAII	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_EJAALF_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAALF_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA ANOS FINAIS
					,CL_EJACOMP_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJACOMP_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,CL_EJAMODULAR_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_III=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_IV=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,CL_CIEJAMODULO_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_III =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_IV =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL
					,CL_PROF =COUNT(DISTINCT(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL BASICA
					,CL_PROF_BASICA =COUNT(DISTINCT(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[CL_AEE_CONVENIO] =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--MOVA
					,CL_MOVA =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--SRM ANTIGO SAAI
					,CL_SRM =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--RECUPERACAO PARALELA
					,CL_REC_PARAL =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--PAP
					,CL_PAP = COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--CELP
					,CL_CELP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))

									
					--ATIVIDADE COMPLEMENTAR
					,CL_ATIV_COMP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CONVERT(NVARCHAR,A.CRDATE,103) AS CRDATE
				
				
				FROM SME_ESCOLA_DIARIO A 
				LEFT JOIN SME_CLASSES_DIARIO B ON A.CD_ESCOLA = B.CD_ESCOLA
				LEFT JOIN ##TIPO_PROGRAMA C ON B.CD_TIPO_PROGRAMA = C.CD_TIPO_PROGRAMA
				WHERE
				CD_SIT = 1 
				AND TP_ESCOLA NOT IN (15,29)  
				AND isnull(B.CD_MODALIDADE_ENSINO,0) <> 2

				GROUP BY 
				 NOMEDEP
				,REDE
				,DRE
				,DISTR
				,SETOR
				,SG_TP_ESCOLA
				,A.CD_ESCOLA
				,RIGHT(COD_ESC,6) 
				,NOMESC
				,ENDERECO
				,NR
				,COMPL
				,BAIRRO
				,CEP
				,DDD
				,FONE1
				,FONE2
				,FAX
				,EMAIL
				,ZONA
				,A.CRDATE

				) AS A
LEFT JOIN (	SELECT	CD_UNIDADE_EDUCACAO AS CD_ESCOLA	
					,SL_EI = COUNT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
						
					,SL_CRECHE = COUNT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_B1 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (1,3,307) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_B2 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (4,6,308) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					--CRECHE/MINIGRUPOS
					,SL_MG1 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (11,27,309) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_MG2 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (28,29,311) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_MG_UNI = COUNT(CASE WHEN CD_SERIE_ENSINO IN (321,322) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					--INFANTIL/PRE ESCOLA
					,SL_PRE = COUNT(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_IN1 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (23,24,313) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_IN2 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (25,26,314) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_IN_UNI = COUNT(CASE WHEN CD_SERIE_ENSINO IN (297,319,320) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_INL = COUNT(CASE WHEN CD_SERIE_ENSINO IN (224,225) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)

					,SL_FUND = COUNT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_FINI = COUNT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F1 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (84,250) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F2 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (86,251) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F3 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (88,252) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F4 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (235,253) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F5 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (236,254) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_FFIN = COUNT(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F6 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (232,255) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F7 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (237,256) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F8 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (238,257) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_F9 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (239,258) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					
					--MÉDIO
					,SL_MEDI = COUNT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_M1 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_M2 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_M3 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_M4 = COUNT(CASE WHEN CD_SERIE_ENSINO IN (107,108) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					--EJA ANOS INICIAIS
					,SL_EJA		 =COUNT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAI	 =COUNT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAII	 =COUNT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					,SL_EJAALF_I =COUNT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAALF_II =COUNT(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJABAS_I =COUNT(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJABAS_II =COUNT(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					--EJA ANOS FINAIS
					,SL_EJACOMP_I =COUNT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJACOMP_II =COUNT(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAFIN_I =COUNT(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAFIN_II =COUNT(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,SL_EJAMODULAR_I =COUNT(CASE WHEN CD_SERIE_ENSINO IN (49,50,212) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAMODULAR_II =COUNT(CASE WHEN CD_SERIE_ENSINO IN (55,56,213) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAMODULAR_III=COUNT(CASE WHEN CD_SERIE_ENSINO IN (67,68,210) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_EJAMODULAR_IV=COUNT(CASE WHEN CD_SERIE_ENSINO IN (71,72,211) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,SL_CIEJAMODULO_I =COUNT(CASE WHEN CD_SERIE_ENSINO IN (35,36) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_CIEJAMODULO_II =COUNT(CASE WHEN CD_SERIE_ENSINO IN (39,40) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_CIEJAMODULO_III =COUNT(CASE WHEN CD_SERIE_ENSINO IN (43,44) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					,SL_CIEJAMODULO_IV =COUNT(CASE WHEN CD_SERIE_ENSINO IN (47,48) THEN CD_SOLICITACAO_MATRICULA ELSE NULL END)
					FROM D_SOLICITACAO_MATRICULA 
					WHERE	AN_LETIVO = YEAR(GETDATE())
						AND ST_SOLICITACAO = 'E'--INCLUI O ANO LETIVO EM 14/10/2019 POR CONTA DA CONTINUIDADE...REDUNDANTE MAS PARA TENTAR PEGAR POSSIVEL FALHA DE LOGICA NO FUTURO...
						AND (cd_etapa_ensino IN (1,10) AND TP_ORIGEM IN ('C','I') OR cd_etapa_ensino NOT IN (1,10) AND TP_ORIGEM IN ('C','I','T','P','A','R'))
					GROUP BY CD_UNIDADE_EDUCACAO
			) AS B ON A.CD_ESCOLA = B.CD_ESCOLA  


--/*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----MISME ESCOLA TOTAL 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

IF EXISTS 
(SELECT * FROM SYSOBJECTS WHERE NAME = 'D_MISME_ESCOLA_TOTAL')
DROP TABLE D_MISME_ESCOLA_TOTAL

SELECT 
	 NOMEDEP
	,REDE 
	,DRE
	,DISTR
	,SETOR
	,SG_TP_ESCOLA
	,A.CD_ESCOLA
	,RIGHT(COD_ESC,6) COD_ESC
	,NOMESC
	,ENDERECO
	,NR
	,COMPL
	,BAIRRO
	,CEP
	,DDD
	,FONE1
	,FONE2
	,FAX
	,UPPER(EMAIL) EMAIL
	,ZONA
	,TURNO_M = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'X' ELSE NULL END
	,TURNO_I = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'X' ELSE NULL END
	,TURNO_T = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'X' ELSE NULL END
	,TURNO_V = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'X' ELSE NULL END
	,TURNO_N = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'X' ELSE NULL END
	,TURNO_G = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'X' ELSE NULL END

	,TURNOS = ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'M' END,'') 
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'I' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'T' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'V' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'N' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'G' END,'')

/*================================================================================================
--ALUNOS
================================================================================================*/
--CRECHE/BERÇARIO
					,MT_EI = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END) 											
																																																																																							
					,MT_CRECHE = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)														
					,MT_B1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
					,MT_B2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
																																																																												
					--CRECHE/MINIGRUPOS																																																																														
					,MT_MG1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
																																																																																							
					--INFANTIL/PRE ESCOLA																																																																													
					,MT_PRE = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_IN1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,313)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
					,MT_IN2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (25,26,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_IN_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
										
					--FUNDAMENTAL
					,MT_FUND = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	
					,MT_FINI = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)										
					,MT_F1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F5 = SUM(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_FFIN = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)											
					,MT_F6 = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F7 = SUM(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F8 = SUM(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F9 = SUM(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					
					
					--MÉDIO
					,MT_MEDI = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)							
					,MT_M1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					
					--EJA ANOS INICIAIS
					,MT_EJA		 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	 
					,MT_EJAI	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																									 
					,MT_EJAII	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																											 
				
					,MT_EJAALF_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJAALF_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					,MT_EJABAS_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJABAS_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					
					--EJA ANOS FINAIS
					,MT_EJACOMP_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJACOMP_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJAFIN_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																														 
					,MT_EJAFIN_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,MT_EJAMODULAR_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_III=SUM(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_IV=SUM(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,MT_CIEJAMODULO_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_III =SUM(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_CIEJAMODULO_IV =SUM(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					
					--ED. PROFISSIONAL
					,MT_PROF =SUM(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)
					
					--ED. PROFISSIONAL BASICA
					,MT_PROF_BASICA =SUM(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE   THEN AL_AT ELSE 0 END)
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[MT_AEE_CONVENIO] =SUM(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--MOVA
					,MT_MOVA =SUM(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--SRM ANTIGO SAAI
					,MT_SRM =SUM(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--RECUPERACAO PARALELA
					,MT_REC_PARAL =SUM(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)

					--SELECT * FROM ##TIPO_PROGRAMA
					,MT_PAP =SUM(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--CELP
					,MT_CELP =SUM(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)


					--ATIVIDADE COMPLEMENTAR
					,MT_ATIV_COMP =SUM(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)
				
				/*================================================================================================
				--CLASSES
				================================================================================================*/
					
					,CL_EI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_CRECHE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--CRECHE/MINIGRUPOS
					,CL_MG1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (321,322)    AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--INFANTIL/PRE ESCOLA
					,CL_PRE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,313) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (25,26,314) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--FUNDAMENTAL
					,CL_FUND = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FINI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F5 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FFIN = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F6 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F7 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F8 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F9 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--MÉDIO
					,CL_MEDI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--EJA ANOS INICIAIS
					,CL_EJA		 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAI	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAII	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_EJAALF_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAALF_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA ANOS FINAIS
					,CL_EJACOMP_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJACOMP_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,CL_EJAMODULAR_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_III=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_IV=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,CL_CIEJAMODULO_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_III =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_IV =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL
					,CL_PROF =COUNT(DISTINCT(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL BASICA
					,CL_PROF_BASICA =COUNT(DISTINCT(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[CL_AEE_CONVENIO] =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--MOVA
					,CL_MOVA =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--SRM ANTIGO SAAI
					,CL_SRM =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--RECUPERACAO PARALELA
					,CL_REC_PARAL =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--PAP
					,CL_PAP = COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					--CELP
					,CL_CELP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))

					--ATIVIDADE COMPLEMENTAR
					,CL_ATIV_COMP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CONVERT(NVARCHAR,A.CRDATE,103) AS CRDATE
INTO D_MISME_ESCOLA_TOTAL	

FROM SME_ESCOLA_DIARIO A 
LEFT JOIN SME_CLASSES_DIARIO B ON A.CD_ESCOLA = B.CD_ESCOLA
LEFT JOIN ##TIPO_PROGRAMA C ON B.CD_TIPO_PROGRAMA = C.CD_TIPO_PROGRAMA
WHERE
CD_SIT = 1 
AND TP_ESCOLA NOT IN (15,29)  
AND isnull(B.CD_MODALIDADE_ENSINO,0) <> 2

GROUP BY 
 NOMEDEP
,REDE
,DRE
,DISTR
,SETOR
,SG_TP_ESCOLA
,A.CD_ESCOLA
,RIGHT(COD_ESC,6) 
,NOMESC
,ENDERECO
,NR
,COMPL
,BAIRRO
,CEP
,DDD
,FONE1
,FONE2
,FAX
,EMAIL
,ZONA
,A.CRDATE



/*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--MISME MANHA TARDE NOITE
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/



IF EXISTS 
(SELECT * FROM SYSOBJECTS WHERE NAME = 'D_MISME_ESCOLA_MTN')
DROP TABLE D_MISME_ESCOLA_MTN

SELECT 
	 
	NOMEDEP
	,REDE
	,DRE
	,DISTR
	,SETOR
	,SG_TP_ESCOLA
	,A.CD_ESCOLA
	,RIGHT(COD_ESC,6) COD_ESC
	,NOMESC
	,ENDERECO
	,NR
	,COMPL
	,BAIRRO
	,CEP
	,DDD
	,FONE1
	,FONE2
	,FAX
	,UPPER(EMAIL) EMAIL
	,ZONA
	,TURNO = CASE 
				WHEN CD_TIPO_TURNO IN (1,2) THEN 'MANHA'
				WHEN CD_TIPO_TURNO IN (3,4) THEN 'TARDE'
				WHEN CD_TIPO_TURNO IN (5) THEN 'NOITE'
				WHEN CD_TIPO_TURNO IN (6) THEN 'INTEGRAL'
			ELSE NULL 
			END
	,TURNO_M = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'X' ELSE NULL END
	,TURNO_I = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'X' ELSE NULL END
	,TURNO_T = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'X' ELSE NULL END
	,TURNO_V = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'X' ELSE NULL END
	,TURNO_N = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'X' ELSE NULL END
	,TURNO_G = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'X' ELSE NULL END

	,TURNOS = ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'M' END,'') 
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'I' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'T' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'V' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'N' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'G' END,'')



/*================================================================================================
--ALUNOS
================================================================================================*/
--CRECHE/BERÇARIO
--CRECHE/BERÇARIO
					,MT_EI = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END) 											
																																																																																							
					,MT_CRECHE = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)														
					,MT_B1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
					,MT_B2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
																																																																												
					--CRECHE/MINIGRUPOS																																																																														
					,MT_MG1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
																																																																																							
					--INFANTIL/PRE ESCOLA																																																																													
					,MT_PRE = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_IN1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,313)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
					,MT_IN2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (25,26,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_IN_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
						
					--FUNDAMENTAL
					,MT_FUND = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	
					,MT_FINI = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)										
					,MT_F1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F5 = SUM(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_FFIN = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)											
					,MT_F6 = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F7 = SUM(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F8 = SUM(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F9 = SUM(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					
					
					--MÉDIO
					,MT_MEDI = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)							
					,MT_M1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
		
					--EJA ANOS INICIAIS
					,MT_EJA		 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	 
					,MT_EJAI	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																									 
					,MT_EJAII	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																											 
				
					,MT_EJAALF_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJAALF_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					,MT_EJABAS_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJABAS_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					
					--EJA ANOS FINAIS
					,MT_EJACOMP_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJACOMP_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJAFIN_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																														 
					,MT_EJAFIN_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,MT_EJAMODULAR_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_III=SUM(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_IV=SUM(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,MT_CIEJAMODULO_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_III =SUM(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_CIEJAMODULO_IV =SUM(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					
					--ED. PROFISSIONAL
					,MT_PROF =SUM(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)
					
					--ED. PROFISSIONAL BASICA
					,MT_PROF_BASICA =SUM(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE   THEN AL_AT ELSE 0 END)
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[MT_AEE_CONVENIO] =SUM(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--MOVA
					,MT_MOVA =SUM(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--SRM ANTIGO SAAI
					,MT_SRM =SUM(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--RECUPERACAO PARALELA
					,MT_REC_PARAL =SUM(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)

					--SELECT * FROM ##TIPO_PROGRAMA
					,MT_PAP =SUM(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--CELP
					,MT_CELP =SUM(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)


					--ATIVIDADE COMPLEMENTAR
					,MT_ATIV_COMP =SUM(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)
				
				/*================================================================================================
				--CLASSES
				================================================================================================*/
					
					,CL_EI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_CRECHE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--CRECHE/MINIGRUPOS
					,CL_MG1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (321,322)    AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--INFANTIL/PRE ESCOLA
					,CL_PRE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,313) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (25,26,314) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--FUNDAMENTAL
					,CL_FUND = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FINI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F5 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FFIN = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F6 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F7 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F8 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F9 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--MÉDIO
					,CL_MEDI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
							
					
					--EJA ANOS INICIAIS
					,CL_EJA		 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAI	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAII	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_EJAALF_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAALF_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA ANOS FINAIS
					,CL_EJACOMP_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJACOMP_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,CL_EJAMODULAR_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_III=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_IV=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,CL_CIEJAMODULO_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_III =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_IV =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL
					,CL_PROF =COUNT(DISTINCT(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL BASICA
					,CL_PROF_BASICA =COUNT(DISTINCT(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[CL_AEE_CONVENIO] =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--MOVA
					,CL_MOVA =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--SRM ANTIGO SAAI
					,CL_SRM =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--RECUPERACAO PARALELA
					,CL_REC_PARAL =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--PAP
					,CL_PAP = COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					--CELP
					,CL_CELP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))

					--ATIVIDADE COMPLEMENTAR
					,CL_ATIV_COMP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CONVERT(NVARCHAR,A.CRDATE,103) AS CRDATE
				
INTO D_MISME_ESCOLA_MTN	

FROM SME_ESCOLA_DIARIO A 
LEFT JOIN SME_CLASSES_DIARIO B ON A.CD_ESCOLA = B.CD_ESCOLA
LEFT JOIN ##TIPO_PROGRAMA C ON B.CD_TIPO_PROGRAMA = C.CD_TIPO_PROGRAMA
WHERE
CD_SIT = 1 
AND TP_ESCOLA NOT IN (15,29)  
AND isnull(B.CD_MODALIDADE_ENSINO,0) <> 2

GROUP BY 
 
NOMEDEP
,REDE
,DRE
,DISTR
,SETOR
,SG_TP_ESCOLA
,A.CD_ESCOLA
,RIGHT(COD_ESC,6) 
,NOMESC
,ENDERECO
,NR
,COMPL
,BAIRRO
,CEP
,DDD
,FONE1
,FONE2
,FAX
,EMAIL
,ZONA
,CASE 
				WHEN CD_TIPO_TURNO IN (1,2) THEN 'MANHA'
				WHEN CD_TIPO_TURNO IN (3,4) THEN 'TARDE'
				WHEN CD_TIPO_TURNO IN (5) THEN 'NOITE'
				WHEN CD_TIPO_TURNO IN (6) THEN 'INTEGRAL'
			ELSE NULL END
,A.CRDATE
/*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--MISME MANHA TARDE NOITE
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/

 

IF EXISTS 
(SELECT * FROM SYSOBJECTS WHERE NAME = 'D_MISME_ESCOLA_TURNO')
DROP TABLE D_MISME_ESCOLA_TURNO

SELECT 
	 
	NOMEDEP
	,REDE
	,DRE
	,DISTR
	,SETOR
	,SG_TP_ESCOLA
	,A.CD_ESCOLA
	,RIGHT(COD_ESC,6) COD_ESC
	,NOMESC
	,ENDERECO
	,NR
	,COMPL
	,BAIRRO
	,CEP
	,DDD
	,FONE1
	,FONE2
	,FAX
	,UPPER(EMAIL) EMAIL
	,ZONA
	,CD_TIPO_TURNO AS TURNO 
	,TURNO_M = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'X' ELSE NULL END
	,TURNO_I = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'X' ELSE NULL END
	,TURNO_T = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'X' ELSE NULL END
	,TURNO_V = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'X' ELSE NULL END
	,TURNO_N = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'X' ELSE NULL END
	,TURNO_G = CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'X' ELSE NULL END

	,TURNOS = ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 1) THEN 'M' END,'') 
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 2) THEN 'I' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 3) THEN 'T' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 4) THEN 'V' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 5) THEN 'N' END,'')
			+ ISNULL(CASE WHEN EXISTS (SELECT * FROM ##AUX_TURNO D WHERE A.CD_ESCOLA = D.CD_ESCOLA AND CD_TIPO_TURNO = 6) THEN 'G' END,'')



/*================================================================================================
--ALUNOS
================================================================================================*/
--CRECHE/BERÇARIO
					,MT_EI = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END) 											
																																																																																							
					,MT_CRECHE = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)														
					,MT_B1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
					,MT_B2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																			
																																																																												
					--CRECHE/MINIGRUPOS																																																																														
					,MT_MG1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_MG_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
																																																																																							
					--INFANTIL/PRE ESCOLA																																																																													
					,MT_PRE = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_IN1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (23,24,313)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
					,MT_IN2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (25,26,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_IN_UNI = SUM(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																	
										
					--FUNDAMENTAL
					,MT_FUND = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	
					,MT_FINI = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)										
					,MT_F1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F5 = SUM(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_FFIN = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)											
					,MT_F6 = SUM(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F7 = SUM(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F8 = SUM(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					,MT_F9 = SUM(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
					
					
					--MÉDIO
					,MT_MEDI = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)							
					,MT_M1 = SUM(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M2 = SUM(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M3 = SUM(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																
					,MT_M4 = SUM(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																		
			
					--EJA ANOS INICIAIS
					,MT_EJA		 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)	 
					,MT_EJAI	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																									 
					,MT_EJAII	 =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																											 
				
					,MT_EJAALF_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJAALF_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					,MT_EJABAS_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																											 
					,MT_EJABAS_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																												 
					
					--EJA ANOS FINAIS
					,MT_EJACOMP_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJACOMP_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					,MT_EJAFIN_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																														 
					,MT_EJAFIN_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)																																													 
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,MT_EJAMODULAR_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_III=SUM(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_EJAMODULAR_IV=SUM(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,MT_CIEJAMODULO_I =SUM(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_II =SUM(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					,MT_CIEJAMODULO_III =SUM(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)		
					,MT_CIEJAMODULO_IV =SUM(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)			
					
					--ED. PROFISSIONAL
					,MT_PROF =SUM(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  THEN AL_AT ELSE 0 END)
					
					--ED. PROFISSIONAL BASICA
					,MT_PROF_BASICA =SUM(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE   THEN AL_AT ELSE 0 END)
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[MT_AEE_CONVENIO] =SUM(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--MOVA
					,MT_MOVA =SUM(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--SRM ANTIGO SAAI
					,MT_SRM =SUM(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--RECUPERACAO PARALELA
					,MT_REC_PARAL =SUM(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)

					--SELECT * FROM ##TIPO_PROGRAMA
					,MT_PAP =SUM(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  THEN AL_AT ELSE 0 END)
					
					--CELP
					,MT_CELP =SUM(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)

					--ATIVIDADE COMPLEMENTAR
					,MT_ATIV_COMP =SUM(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  THEN AL_AT ELSE 0 END)
				
				/*================================================================================================
				--CLASSES
				================================================================================================*/
					
					,CL_EI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,23,24,297,25,26,319,320,321,322,307,308,309,311,313,314)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_CRECHE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,4,6,11,27,28,29,307,308,309,311,321,322)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (1,3,307)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_B2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (4,6,308)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--CRECHE/MINIGRUPOS
					,CL_MG1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (11,27,309)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (28,29,311)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_MG_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (321,322)    AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--INFANTIL/PRE ESCOLA
					,CL_PRE = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,297,25,26,313,314,319,320) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (23,24,313) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (25,26,314) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_IN_UNI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (297,319,320)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--FUNDAMENTAL
					,CL_FUND = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254,232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FINI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250,86,251,88,252,235,253,236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (84,250)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (86,251)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (88,252)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (235,253)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F5 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (236,254)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_FFIN = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255,237,256,238,257,239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F6 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (232,255)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F7 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (237,256)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F8 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (238,257)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_F9 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (239,258)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					
					--MÉDIO
					,CL_MEDI = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,91,99,103,104,92,100,105,106,107,108,303,304,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M1 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (90,98,101,102,303)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M2 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (91,99,103,104,304)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M3 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (92,100,105,106,305)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_M4 = COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (107,108)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
						
					
					--EJA ANOS INICIAIS
					,CL_EJA		 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,49,50,212,55,56,213,67,68,210,71,72,211,35,36,39,40,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAI	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289,275,277,290,291,278,279,241,292,293,280,281,294,295,49,50,212,55,56,213,35,36,39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAII	 =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269,266,247,262,270,267,248,263,271,268,249,264,272,67,68,210,71,72,211,43,44,47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CL_EJAALF_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (274,276,240,288,289)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAALF_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (275,277,290,291)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (278,279,241,292,293)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJABAS_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (280,281,294,295)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA ANOS FINAIS
					,CL_EJACOMP_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (246,265,261,269)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJACOMP_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (266,247,262,270)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (267,248,263,271)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAFIN_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (268,249,264,272)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MODULAR -- ANUAL - ALUNO ENTRA E SAI A QUALQUER MOMENTO
					,CL_EJAMODULAR_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (49,50,212)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (55,56,213)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_III=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (67,68,210)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_EJAMODULAR_IV=COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (71,72,211)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--EJA MÓDULO -- ANUAL - ALUNO ENTRA SOMENTE NO INICIO DA TURMA
					,CL_CIEJAMODULO_I =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (35,36)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_II =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (39,40)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_III =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (43,44)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					,CL_CIEJAMODULO_IV =COUNT(DISTINCT(CASE WHEN CD_SERIE_ENSINO IN (47,48)  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL
					,CL_PROF =COUNT(DISTINCT(CASE WHEN(CD_ETAPA_ENSINO IN (14)  OR TIPO_PROG IN ('ED. PROF. ESCOLA MUSICA')) AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ED. PROFISSIONAL BASICA
					,CL_PROF_BASICA =COUNT(DISTINCT(CASE WHEN  TIPO_PROG IN ('ED. PROF. BASICA - CMCT')  AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--ATENDIMENTO EDUCACIONAL PERSONALIZADO
					,[CL_AEE_CONVENIO] =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('CAEE - CONVENIOS ESPECIAIS')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--MOVA
					,CL_MOVA =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('MOVA')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--SRM ANTIGO SAAI
					,CL_SRM =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('SALA DE RECURSO MULTIFUNCIONAL')  /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--RECUPERACAO PARALELA
					,CL_REC_PARAL =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('RECUPERACAO PARALELA') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					--PAP
					,CL_PAP = COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('PAP RECUP.DE APRENDIZAGENS') /* AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE */  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					--CELP
					,CL_CELP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('celp')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))

					--ATIVIDADE COMPLEMENTAR
					,CL_ATIV_COMP =COUNT(DISTINCT(CASE WHEN TIPO_PROG IN ('ATIVIDADE COMPLEMENTAR')  /*AND CASE WHEN CD_TIPO_PERIODICIDADE  IN (1,2) THEN 0 WHEN CD_TIPO_PERIODICIDADE  IN (3) THEN 1 WHEN CD_TIPO_PERIODICIDADE  IN (4) THEN 2 ELSE CD_TIPO_PERIODICIDADE END <> @DURCLASSE*/  AND ST_TURMA_ESCOLA NOT IN ('E','C') THEN CD_TURMA_ESCOLA ELSE NULL END))
					
					,CONVERT(NVARCHAR,A.CRDATE,103) AS CRDATE
	INTO D_MISME_ESCOLA_TURNO	

FROM SME_ESCOLA_DIARIO A 
LEFT JOIN SME_CLASSES_DIARIO B ON A.CD_ESCOLA = B.CD_ESCOLA
LEFT JOIN ##TIPO_PROGRAMA C ON B.CD_TIPO_PROGRAMA = C.CD_TIPO_PROGRAMA
WHERE
CD_SIT = 1 
AND TP_ESCOLA NOT IN (15,29)  
AND isnull(B.CD_MODALIDADE_ENSINO,0) <> 2

GROUP BY 
 
NOMEDEP
,REDE
,DRE
,DISTR
,SETOR
,SG_TP_ESCOLA
,A.CD_ESCOLA
,RIGHT(COD_ESC,6) 
,NOMESC
,ENDERECO
,NR
,COMPL
,BAIRRO
,CEP
,DDD
,FONE1
,FONE2
,FAX
,EMAIL
,ZONA
,CD_TIPO_TURNO
,A.CRDATE
/*--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
----MISME EDUCACAO ESPECIAL TOTAL 
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------*/


--DECLARE @date VARCHAR(255) = '12/5/2019';  
--SELECT EOMONTH ( @date ) AS Result;  

GO


